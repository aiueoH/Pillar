package com.pillar;

import java.lang.reflect.Field;
import java.util.HashMap;
import java.util.Map;

import org.andengine.opengl.texture.TextureManager;
import org.andengine.opengl.texture.TextureOptions;
import org.andengine.opengl.texture.atlas.bitmap.BitmapTextureAtlas;
import org.andengine.opengl.texture.atlas.bitmap.BitmapTextureAtlasTextureRegionFactory;
import org.andengine.opengl.texture.region.TiledTextureRegion;
import org.andengine.ui.activity.BaseGameActivity;

import android.R.integer;

public class MyTexturePacker {
	
	public enum TKey {
		PB,
		PB_BORDER,
		NB,
		FISH,
	};
	
	private static TPacker _instance;
	private Map<TKey, TiledTextureRegion> _textures;
	
	private BaseGameActivity _activity; 
	
	private MyTexturePacker() {
		_textures = new HashMap<TKey, TiledTextureRegion>();
	}
	
	public static TPacker getInstance() {
		if (_instance == null)
			synchronized (TPacker.class) {
				if (_instance == null)
					_instance = new TPacker();
			}
		return _instance;
	}
	
	public void load(final BaseGameActivity baseGameActivity) {
		_activity = baseGameActivity;
		BitmapTextureAtlasTextureRegionFactory.setAssetBasePath("gfx/");
		
		load(TKey.PB, "pb.png", 300, 100, 0, 0, 1, 1);
		load(TKey.PB_BORDER, "pbb.png", 300, 100, 0, 0, 1, 1);
		load(TKey.NB, "nb.png", 300, 100, 0, 0, 1, 1);
		load(TKey.FISH, "fish_g.png", 300, 1700, 0, 0, 1, 17);
	}
	
	private void load(TKey key, String file, int w, int h, int x, int y, int c, int r) {
		BitmapTextureAtlas bta = new BitmapTextureAtlas(_activity.getTextureManager(), w, h);
		TiledTextureRegion ttr = BitmapTextureAtlasTextureRegionFactory.createTiledFromAsset(bta, _activity, file, x, y, c, r);
		bta.load();
		_textures.put(key, ttr);
	}
	
	public TiledTextureRegion getTTR(TKey key) {
		return _textures.get(key);
	}

}
